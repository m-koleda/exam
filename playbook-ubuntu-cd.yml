---
- hosts: all
  become: true
  vars_files:
    - vars/default.yml

  tasks:

    - name: Copy files from local host to remote host
      copy:
        src: "webapp/"
        dest: "/var/www/{{ http_host }}/wordpress"
        owner: www-data
        group: www-data
        mode: '0640'
        force: true
#    - name: Set ownership
#      file:
#        path: "/var/www/{{ http_host }}"
#        state: directory
#        recurse: yes
#        owner: www-data
#        group: www-data
#      tags: [ wordpress ]

#    - name: Set permissions for directories
#      shell: "/usr/bin/find /var/www/{{ http_host }}/wordpress/ -type d -exec chmod 750 {} \\;"
#      tags: [ wordpress ]

#    - name: Set permissions for files
#      shell: "/usr/bin/find /var/www/{{ http_host }}/wordpress/ -type f -exec chmod 640 {} \\;"
#      tags: [ wordpress ]

    - name: Restart Apache
      service:
        name: apache2
        state: restarted
